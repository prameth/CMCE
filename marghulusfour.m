clc;
x1 = [0 0.0932 0.1248 0.1757 0.2 0.2626 0.3615 0.475 0.5555 0.6718 0.878 0.9398 1];
x2 = 1-x1;
y1 = [0 0.1794 0.2383 0.3302 0.3691 0.4628 0.6184 0.7552 0.8378 0.9137 0.9860 0.9945 1];
y2 = 1-y1;
p = [15.79 17.51 18.15 19.3 19.89 21.37 24.95 29.82 34.8 42.1 60.38 65.39 69.36];
n = length(x1);
a1 = 6.95465;
b1 = 1170.97;
c1 = 226.232;
a2 = 7.43155;
b2 = 1554.679;
c2 = 240.337;
A12 = 3.94451026681831;
A21 = 7.44734309554601;
C = 14.0112410573422;
P = 20;
t1=-c1+(b1/(a1-log10(P)))
t2=-c2+(b2/(a2-log10(P)))
for i=1:13
    gamma1(i)= exp((x2(i)^2)*(A12+(2*(A21-A12-C)*x1(i))+(3*(x1(i)^2)*C)));
    gamma2(i)= exp((x1(i)^2)*(A21+(2*(A12-A21-C)*x2(i))+(3*(x2(i)^2)*C)));
end
for i=1:n
    tfun=@(t)((x1(i)*gamma1(i)*(10^(a1-(b1/(t+c1))))) + (x2(i)*gamma2(i)*(10^(a2-(b2/(t+c2)))))-P);
    t0(i)=x1(i)*t1+x2(i)*t2;
    t(i)=fzero(tfun,t0(i));
end
for i=1:n
    yc1(i)=(x1(i)*gamma1(i)*10^(a1-(b1/(t(i)+c1))))/P;
end
yc2=1-yc1;
temp = t(1:13);
gamma1
gamma2
yc1
figure;
plot(x1,temp,'r',y1,temp,'b',yc1,temp,'p');